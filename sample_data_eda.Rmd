---
title: "Code Chalange Tenchi Security"
author: "Jo√£o L M Resende"
date: "30 january 2022"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(knitr)

```

# Report for Abin 
This is a report to show about cyber breach information. 
```{r load data, include=FALSE}
sample_breaches <- read.csv("sample_breaches.csv")
```

## Summary of the Data

```{r sample_breaches, include=FALSE}
summary(sample_breaches)
```

  This data shows that the mean value of each breach is **\$`r format(mean(sample_breaches$total_amount), scientific = FALSE, big.mark = ",")` **. Te minimum value of the breach is **\$`r format(min(sample_breaches$total_amount), scientific = FALSE, big.mark = ",")` **, and he maximum value is **\$`r format(max(sample_breaches$total_amount), scientific = FALSE, big.mark = ",")` **
  
The 5 sectors which more occurrence of breach of information are shown in the table below:

```{r, echo=FALSE}

freq_sector <- sample_breaches %>% 
  group_by(sector) %>% 
  count(sort = TRUE, name = "Occurrence")

kable(head(freq_sector,5), caption = "Ocurrence per secto")

```

As we can see, the **`r head(freq_sector$sector,1)`** is the leader of breach of information, with **`r head(freq_sector$Occurrence,1)`** occurrence.  Now, in the plot below we can see the division between external and internal causes.  

```{r, echo =FALSE,out.width = "300px"}

sample_breaches <- sample_breaches %>% 
  mutate(causes_int_ext = str_extract(cause, "[^ -]*"))#creation of column to divide causes in externals and internals

plot_ex_int_cause <- sample_breaches %>% 
  group_by(causes_int_ext) %>% 
  count(sort = TRUE, name = "Occurrence") %>% 
  ggplot(aes(causes_int_ext, Occurrence, fill = causes_int_ext))+
  geom_col()+
  labs( title = "Causes of breaches",
        subtitle = "",
        x = "",
        y = "Occurrence",
        fill = "")+
   scale_fill_manual(values = c("#047BAE", "#B1DCE3"),guide="none")

plot_ex_int_cause

```

  As we can see, the majority of breaches are caused from external causes, with almost double of the internal ones.  
  
  In the next plot we gonna see the top five occurrence, divide in external and internal causes, for this analysis the events without causes are going to be excluded. 

```{r, echo =FALSE, out.width = "300px"}
sample_breaches %>% 
  filter(!is.na(cause)) %>% 
  group_by(causes_int_ext) %>% 
  count(cause) %>% 
  mutate(n = case_when(causes_int_ext == "External" ~ -n,
                       TRUE ~ n),
         cause = fct_reorder(cause, n)) %>% 
  ggplot(aes(cause, n, color =causes_int_ext )) +
  geom_segment(aes(x = cause, xend = cause, y = 0, yend = n),
               color = "gray", lwd = 1.5) +
  geom_point(size = 4, show.legend = FALSE) +
  coord_flip()+
  scale_y_continuous(breaks=seq(-800, 800,by=200), labels=abs(seq(-800, 800,by=200)))+
  labs( title = "Number of breaches",
        subtitle = "",
        x = "Causes",
        y = "Occurrence",
        fill = "")


```
  
 As we expected, the variety of external causes is bigger, as seen in the previous plot. Another fact to be in mind is that in both groups external and internal, the difference between the biggest reason for breaches and the smallest is approximately 100.
 
 In the next analysis we can see the distribution of affected_count, that is, how the count of data records involved in the breach is distributed.
 
```{r}
sample_breaches %>%
  ggplot(aes(total_amount, sector))+
  geom_boxplot()+
  labs( title = "Number of breaches",
        subtitle = "",
        x = "Causes",
        y = "Occurrence",
        fill = "")
```
 

